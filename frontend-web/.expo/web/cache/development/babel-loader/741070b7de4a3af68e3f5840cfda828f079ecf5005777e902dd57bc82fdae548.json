{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport LoginScreen from \"./LoginScreen\";\nimport RegisterScreen from \"./RegisterScreen\";\nimport DashboardScreen from \"./DashboardScreen\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar API_BASE_URL = 'http://localhost:8000';\nexport default function App() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    authToken = _useState2[0],\n    setAuthToken = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    currentUser = _useState4[0],\n    setCurrentUser = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loadingUser = _useState6[0],\n    setLoadingUser = _useState6[1];\n  var _useState7 = useState('login'),\n    _useState8 = _slicedToArray(_useState7, 2),\n    screen = _useState8[0],\n    setScreen = _useState8[1];\n  useEffect(function () {\n    function loadUserData() {\n      return _loadUserData.apply(this, arguments);\n    }\n    function _loadUserData() {\n      _loadUserData = _asyncToGenerator(function* () {\n        setLoadingUser(true);\n        try {\n          var token = yield AsyncStorage.getItem('authToken');\n          var userString = yield AsyncStorage.getItem('currentUser');\n          if (token && userString) {\n            setAuthToken(token);\n            setCurrentUser(JSON.parse(userString));\n            setScreen('dashboard');\n          }\n        } catch (e) {\n          console.log('Error cargando datos de usuario', e);\n        } finally {\n          setLoadingUser(false);\n        }\n      });\n      return _loadUserData.apply(this, arguments);\n    }\n    loadUserData();\n  }, []);\n  function onLoginSuccess(_x) {\n    return _onLoginSuccess.apply(this, arguments);\n  }\n  function _onLoginSuccess() {\n    _onLoginSuccess = _asyncToGenerator(function* (token) {\n      setAuthToken(token);\n      try {\n        var res = yield fetch(`${API_BASE_URL}/me`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (res.ok) {\n          var user = yield res.json();\n          setCurrentUser(user);\n          yield AsyncStorage.setItem('authToken', token);\n          yield AsyncStorage.setItem('currentUser', JSON.stringify(user));\n          setScreen('dashboard');\n        } else {\n          Alert.alert('Error', 'No se pudo obtener datos del usuario');\n        }\n      } catch (_unused) {\n        Alert.alert('Error', 'Error de conexión');\n      }\n    });\n    return _onLoginSuccess.apply(this, arguments);\n  }\n  function handleLogout() {\n    setAuthToken(null);\n    setCurrentUser(null);\n    AsyncStorage.removeItem('authToken');\n    AsyncStorage.removeItem('currentUser');\n    setScreen('login');\n  }\n  if (loadingUser) {\n    return _jsxs(View, {\n      style: styles.center,\n      children: [_jsx(ActivityIndicator, {\n        size: \"large\"\n      }), _jsx(Text, {\n        children: \"Cargando...\"\n      })]\n    });\n  }\n  if (screen === 'login') {\n    return _jsx(LoginScreen, {\n      onLoginSuccess: onLoginSuccess,\n      goToRegister: function goToRegister() {\n        return setScreen('register');\n      }\n    });\n  }\n  if (screen === 'register') {\n    return _jsx(RegisterScreen, {\n      goToLogin: function goToLogin() {\n        return setScreen('login');\n      }\n    });\n  }\n  if (screen === 'dashboard') {\n    return _jsx(DashboardScreen, {\n      user: currentUser,\n      token: authToken,\n      onLogout: handleLogout\n    });\n  }\n  return _jsx(View, {\n    style: styles.center,\n    children: _jsx(Text, {\n      children: \"Pantalla desconocida\"\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  center: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","View","Text","Button","Alert","StyleSheet","ActivityIndicator","LoginScreen","RegisterScreen","DashboardScreen","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","App","_useState","_useState2","_slicedToArray","authToken","setAuthToken","_useState3","_useState4","currentUser","setCurrentUser","_useState5","_useState6","loadingUser","setLoadingUser","_useState7","_useState8","screen","setScreen","loadUserData","_loadUserData","apply","arguments","_asyncToGenerator","token","AsyncStorage","getItem","userString","JSON","parse","e","console","log","onLoginSuccess","_x","_onLoginSuccess","res","fetch","headers","Authorization","ok","user","json","setItem","stringify","alert","_unused","handleLogout","removeItem","style","styles","center","children","size","goToRegister","goToLogin","onLogout","create","flex","justifyContent","alignItems"],"sources":["C:/Users/borji/Desktop/appPython/webRobotica/frontend-web/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, Text, Button, Alert, StyleSheet, ActivityIndicator } from 'react-native';\r\n\r\nimport LoginScreen from './LoginScreen';     // Te pasé un ejemplo antes\r\nimport RegisterScreen from './RegisterScreen'; // Te haré un ejemplo similar si quieres\r\nimport DashboardScreen from './DashboardScreen'; // Pantalla principal después de login\r\n\r\nconst API_BASE_URL = 'http://localhost:8000';\r\n\r\nexport default function App() {\r\n  const [authToken, setAuthToken] = useState(null);\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [loadingUser, setLoadingUser] = useState(false);\r\n  const [screen, setScreen] = useState('login'); // 'login' | 'register' | 'dashboard'\r\n\r\n  // Al iniciar app, intento cargar token y user del asyncStorage (localStorage no existe en RN)\r\n  useEffect(() => {\r\n    async function loadUserData() {\r\n      setLoadingUser(true);\r\n      try {\r\n        const token = await AsyncStorage.getItem('authToken');\r\n        const userString = await AsyncStorage.getItem('currentUser');\r\n        if (token && userString) {\r\n          setAuthToken(token);\r\n          setCurrentUser(JSON.parse(userString));\r\n          setScreen('dashboard');\r\n        }\r\n      } catch (e) {\r\n        console.log('Error cargando datos de usuario', e);\r\n      } finally {\r\n        setLoadingUser(false);\r\n      }\r\n    }\r\n    loadUserData();\r\n  }, []);\r\n\r\n  async function onLoginSuccess(token) {\r\n    setAuthToken(token);\r\n\r\n    try {\r\n      const res = await fetch(`${API_BASE_URL}/me`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      if (res.ok) {\r\n        const user = await res.json();\r\n        setCurrentUser(user);\r\n        await AsyncStorage.setItem('authToken', token);\r\n        await AsyncStorage.setItem('currentUser', JSON.stringify(user));\r\n        setScreen('dashboard');\r\n      } else {\r\n        Alert.alert('Error', 'No se pudo obtener datos del usuario');\r\n      }\r\n    } catch {\r\n      Alert.alert('Error', 'Error de conexión');\r\n    }\r\n  }\r\n\r\n  function handleLogout() {\r\n    setAuthToken(null);\r\n    setCurrentUser(null);\r\n    AsyncStorage.removeItem('authToken');\r\n    AsyncStorage.removeItem('currentUser');\r\n    setScreen('login');\r\n  }\r\n\r\n  if (loadingUser) {\r\n    return (\r\n      <View style={styles.center}>\r\n        <ActivityIndicator size=\"large\" />\r\n        <Text>Cargando...</Text>\r\n      </View>\r\n    );\r\n  }\r\n\r\n  if (screen === 'login') {\r\n    return (\r\n      <LoginScreen\r\n        onLoginSuccess={onLoginSuccess}\r\n        goToRegister={() => setScreen('register')}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (screen === 'register') {\r\n    return (\r\n      <RegisterScreen\r\n        goToLogin={() => setScreen('login')}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (screen === 'dashboard') {\r\n    return (\r\n      <DashboardScreen\r\n        user={currentUser}\r\n        token={authToken}\r\n        onLogout={handleLogout}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <View style={styles.center}>\r\n      <Text>Pantalla desconocida</Text>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  center: { flex: 1, justifyContent: 'center', alignItems: 'center' }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}