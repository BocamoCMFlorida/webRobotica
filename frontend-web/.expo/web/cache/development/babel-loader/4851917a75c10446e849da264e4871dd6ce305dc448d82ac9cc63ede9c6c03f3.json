{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect } from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport LoginScreen from \"./LoginScreen\";\nimport RegisterScreen from \"./RegisterScreen\";\nimport AdminDashboard from \"./AdminDashboard\";\nimport StudentDashboard from \"./StudentDashboard\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nvar Stack = createStackNavigator();\nvar LoadingScreen = function LoadingScreen() {\n  return _jsxs(View, {\n    style: styles.loadingContainer,\n    children: [_jsx(ActivityIndicator, {\n      size: \"large\",\n      color: \"#007AFF\"\n    }), _jsx(Text, {\n      style: styles.loadingText,\n      children: \"Cargando...\"\n    })]\n  });\n};\nexport default function App() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    token = _useState2[0],\n    setToken = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    role = _useState4[0],\n    setRole = _useState4[1];\n  var _useState5 = useState(true),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isAuthenticated = _useState8[0],\n    setIsAuthenticated = _useState8[1];\n  useEffect(function () {\n    function loadSession() {\n      return _loadSession.apply(this, arguments);\n    }\n    function _loadSession() {\n      _loadSession = _asyncToGenerator(function* () {\n        try {\n          var savedToken = yield AsyncStorage.getItem('access_token');\n          var savedRole = yield AsyncStorage.getItem('user_role');\n          if (savedToken && savedRole) {\n            setToken(savedToken);\n            setRole(savedRole);\n            setIsAuthenticated(true);\n          } else {\n            setIsAuthenticated(false);\n          }\n        } catch (e) {\n          console.error('Error al cargar sesión:', e);\n        } finally {\n          setLoading(false);\n        }\n      });\n      return _loadSession.apply(this, arguments);\n    }\n    loadSession();\n  }, []);\n  var handleLogout = function () {\n    var _ref = _asyncToGenerator(function* () {\n      try {\n        yield AsyncStorage.multiRemove(['access_token', 'user_role', 'user_info']);\n        setToken(null);\n        setRole(null);\n        setIsAuthenticated(false);\n        Alert.alert('Sesión cerrada', 'Has cerrado sesión exitosamente');\n      } catch (error) {\n        console.error('Error al cerrar sesión:', error);\n      }\n    });\n    return function handleLogout() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  if (loading) {\n    return _jsx(LoadingScreen, {});\n  }\n  return _jsx(NavigationContainer, {\n    children: _jsx(Stack.Navigator, {\n      screenOptions: {\n        headerShown: true\n      },\n      children: !isAuthenticated ? _jsxs(_Fragment, {\n        children: [_jsx(Stack.Screen, {\n          name: \"Login\",\n          options: {\n            title: 'Iniciar Sesión'\n          },\n          children: function children(props) {\n            return _jsx(LoginScreen, _objectSpread(_objectSpread({}, props), {}, {\n              setToken: setToken,\n              setRole: setRole,\n              setIsAuthenticated: setIsAuthenticated\n            }));\n          }\n        }), _jsx(Stack.Screen, {\n          name: \"Register\",\n          component: RegisterScreen,\n          options: {\n            title: 'Registro',\n            headerBackTitle: 'Volver'\n          }\n        })]\n      }) : _jsx(_Fragment, {\n        children: role === 'admin' ? _jsx(Stack.Screen, {\n          name: \"AdminDashboard\",\n          options: {\n            title: 'Dashboard'\n          },\n          children: function children(props) {\n            return _jsx(AdminDashboard, _objectSpread(_objectSpread({}, props), {}, {\n              onLogout: handleLogout\n            }));\n          }\n        }) : _jsx(Stack.Screen, {\n          name: \"StudentDashboard\",\n          options: {\n            title: 'Dashboard'\n          },\n          children: function children(props) {\n            return _jsx(StudentDashboard, _objectSpread(_objectSpread({}, props), {}, {\n              onLogout: handleLogout\n            }));\n          }\n        })\n      })\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#f5f5f5'\n  },\n  loadingText: {\n    marginTop: 10,\n    fontSize: 16,\n    color: '#666'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","NavigationContainer","createStackNavigator","View","Text","ActivityIndicator","StyleSheet","Alert","LoginScreen","RegisterScreen","AdminDashboard","StudentDashboard","AsyncStorage","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Stack","LoadingScreen","style","styles","loadingContainer","children","size","color","loadingText","App","_useState","_useState2","_slicedToArray","token","setToken","_useState3","_useState4","role","setRole","_useState5","_useState6","loading","setLoading","_useState7","_useState8","isAuthenticated","setIsAuthenticated","loadSession","_loadSession","apply","arguments","_asyncToGenerator","savedToken","getItem","savedRole","e","console","error","handleLogout","_ref","multiRemove","alert","Navigator","screenOptions","headerShown","Screen","name","options","title","props","_objectSpread","component","headerBackTitle","onLogout","create","flex","justifyContent","alignItems","backgroundColor","marginTop","fontSize"],"sources":["C:/Users/raulv/Desktop/proyectoCantera/webRobotica/frontend-web/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { NavigationContainer } from '@react-navigation/native';\r\nimport { createStackNavigator } from '@react-navigation/stack';\r\nimport { View, Text, ActivityIndicator, StyleSheet, Alert } from 'react-native';\r\n\r\nimport LoginScreen from './LoginScreen';\r\nimport RegisterScreen from './RegisterScreen';\r\nimport AdminDashboard from './AdminDashboard';\r\nimport StudentDashboard from './StudentDashboard';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst Stack = createStackNavigator();\r\n\r\nconst LoadingScreen = () => (\r\n  <View style={styles.loadingContainer}>\r\n    <ActivityIndicator size=\"large\" color=\"#007AFF\" />\r\n    <Text style={styles.loadingText}>Cargando...</Text>\r\n  </View>\r\n);\r\n\r\nexport default function App() {\r\n  const [token, setToken] = useState(null);\r\n  const [role, setRole] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n\r\n  useEffect(() => {\r\n    async function loadSession() {\r\n      try {\r\n        const savedToken = await AsyncStorage.getItem('access_token');\r\n        const savedRole = await AsyncStorage.getItem('user_role');\r\n\r\n        if (savedToken && savedRole) {\r\n          setToken(savedToken);\r\n          setRole(savedRole);\r\n          setIsAuthenticated(true);\r\n        } else {\r\n          setIsAuthenticated(false);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error al cargar sesión:', e);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    loadSession();\r\n  }, []);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await AsyncStorage.multiRemove(['access_token', 'user_role', 'user_info']);\r\n      setToken(null);\r\n      setRole(null);\r\n      setIsAuthenticated(false);\r\n      Alert.alert('Sesión cerrada', 'Has cerrado sesión exitosamente');\r\n    } catch (error) {\r\n      console.error('Error al cerrar sesión:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <LoadingScreen />;\r\n  }\r\n\r\n  return (\r\n    <NavigationContainer>\r\n      <Stack.Navigator screenOptions={{ headerShown: true }}>\r\n        {!isAuthenticated ? (\r\n          <>\r\n            <Stack.Screen \r\n              name=\"Login\"\r\n              options={{ title: 'Iniciar Sesión' }}\r\n            >\r\n              {(props) => (\r\n                <LoginScreen \r\n                  {...props}\r\n                  setToken={setToken}\r\n                  setRole={setRole}\r\n                  setIsAuthenticated={setIsAuthenticated}\r\n                />\r\n              )}\r\n            </Stack.Screen>\r\n            <Stack.Screen \r\n              name=\"Register\"\r\n              component={RegisterScreen}\r\n              options={{ title: 'Registro', headerBackTitle: 'Volver' }}\r\n            />\r\n          </>\r\n        ) : (\r\n          <>\r\n            {role === 'admin' ? (\r\n              <Stack.Screen\r\n                name=\"AdminDashboard\"\r\n                options={{ title: 'Dashboard' }}\r\n              >\r\n                {(props) => (\r\n                  <AdminDashboard\r\n                    {...props}\r\n                    onLogout={handleLogout}\r\n                  />\r\n                )}\r\n              </Stack.Screen>\r\n            ) : (\r\n              <Stack.Screen\r\n                name=\"StudentDashboard\"\r\n                options={{ title: 'Dashboard' }}\r\n              >\r\n                {(props) => (\r\n                  <StudentDashboard\r\n                    {...props}\r\n                    onLogout={handleLogout}\r\n                  />\r\n                )}\r\n              </Stack.Screen>\r\n            )}\r\n          </>\r\n        )}\r\n      </Stack.Navigator>\r\n    </NavigationContainer>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: '#f5f5f5',\r\n  },\r\n  loadingText: {\r\n    marginTop: 10,\r\n    fontSize: 16,\r\n    color: '#666',\r\n  },\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}